
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>4. The power of groupby and aggregation &#8212; An introduction to data analysis in Python</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=62ba249389abaaa9ffc34bf36a076bdc1d65ee18" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=f31d14ad54b65d19161ba51d4ffff3a77ae00456"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="5. Custom functions" href="custom_functions_flow.html" />
    <link rel="prev" title="3. Boolean operations with Pandas" href="booleans.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
      
      
      <h1 class="site-logo" id="site-title">An introduction to data analysis in Python</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    An introduction to data analysis in Python
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  The Basics
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../chapter1/the_basics.html">
   1. The Basics
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../chapter1/data_collections.html">
   2. Data collections
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../chapter1/functions.html">
   3. Functions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../chapter1/loops.html">
   4. Loops
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  NumPy
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../chapter2/imports.html">
   1. Starting data handling in Python - NumPy
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../chapter2/basic_numpy.html">
   2. The
   <code class="docutils literal notranslate">
    <span class="pre">
     numpy
    </span>
   </code>
   module
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../chapter2/stats_simulation.html">
   3. Data indexing, simulation, and summary statistics
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  pandas
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="pandas_import_describe.html">
   1. The
   <code class="docutils literal notranslate">
    <span class="pre">
     pandas
    </span>
   </code>
   module
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="indexing.html">
   2. Accessing data in Pandas
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="booleans.html">
   3. Boolean operations with Pandas
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   4. The power of
   <code class="docutils literal notranslate">
    <span class="pre">
     groupby
    </span>
   </code>
   and aggregation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="custom_functions_flow.html">
   5. Custom functions
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  pandas - advanced uses
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../chapter4/apply.html">
   1. Advanced data handling with
   <code class="docutils literal notranslate">
    <span class="pre">
     pandas
    </span>
   </code>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../chapter4/go_long.html">
   2. Data surgery - reshaping data with
   <code class="docutils literal notranslate">
    <span class="pre">
     melt
    </span>
   </code>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../chapter4/go_wide.html">
   3. There and back again - reshaping data with
   <code class="docutils literal notranslate">
    <span class="pre">
     .pivot_table()
    </span>
   </code>
   .
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../chapter4/merge_join.html">
   4. Data surgery - joining DataFrames with
   <code class="docutils literal notranslate">
    <span class="pre">
     pd.concat
    </span>
   </code>
   and
   <code class="docutils literal notranslate">
    <span class="pre">
     pd.merge
    </span>
   </code>
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Data Visualisation
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../chapter5/matplotlib.html">
   1. Introducing
   <code class="docutils literal notranslate">
    <span class="pre">
     matplotlib
    </span>
   </code>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../chapter5/seaborn.html">
   2. Using
   <code class="docutils literal notranslate">
    <span class="pre">
     seaborn
    </span>
   </code>
   for smoother data visualisation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../chapter5/advanced_seaborn.html">
   3. Advanced plotting with
   <code class="docutils literal notranslate">
    <span class="pre">
     seaborn
    </span>
   </code>
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Statistical Analysis
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../chapter6/pingouin.html">
   1. (Frequentist) Statistics in Python
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../chapter6/statsmodels.html">
   2. Statistics with
   <code class="docutils literal notranslate">
    <span class="pre">
     statsmodels
    </span>
   </code>
   and
   <code class="docutils literal notranslate">
    <span class="pre">
     scipy.stats
    </span>
   </code>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../chapter6/generalised.html">
   3. Generalised Linear Models
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../chapter6/lmm.html">
   4. Hierarchical or mixed models
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../chapter6/ijalm.html">
   5.
   <strong>
    Bonus section
   </strong>
   -
   <strong>
    I
   </strong>
   ts
   <strong>
    J
   </strong>
   ust
   <strong>
    A
   </strong>
   <strong>
    L
   </strong>
   inear
   <strong>
    M
   </strong>
   odel
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/executablebooks/jupyter-book/master?urlpath=tree/docs/chapter3/split_apply_combine.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/executablebooks/jupyter-book"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2Fchapter3/split_apply_combine.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../_sources/chapter3/split_apply_combine.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#reset-index-a-note">
   4.1.
   <code class="docutils literal notranslate">
    <span class="pre">
     .reset_index()
    </span>
   </code>
   - a note
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#other-pandas-data-manipulation-tools-transform">
   4.2. Other pandas data manipulation tools -
   <code class="docutils literal notranslate">
    <span class="pre">
     .transform()
    </span>
   </code>
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#other-pandas-data-manipulation-tools-agg">
   4.3. Other pandas data manipulation tools -
   <code class="docutils literal notranslate">
    <span class="pre">
     .agg()
    </span>
   </code>
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>The power of groupby and aggregation</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#reset-index-a-note">
   4.1.
   <code class="docutils literal notranslate">
    <span class="pre">
     .reset_index()
    </span>
   </code>
   - a note
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#other-pandas-data-manipulation-tools-transform">
   4.2. Other pandas data manipulation tools -
   <code class="docutils literal notranslate">
    <span class="pre">
     .transform()
    </span>
   </code>
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#other-pandas-data-manipulation-tools-agg">
   4.3. Other pandas data manipulation tools -
   <code class="docutils literal notranslate">
    <span class="pre">
     .agg()
    </span>
   </code>
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section id="the-power-of-groupby-and-aggregation">
<h1><span class="section-number">4. </span>The power of <code class="docutils literal notranslate"><span class="pre">groupby</span></code> and aggregation<a class="headerlink" href="#the-power-of-groupby-and-aggregation" title="Permalink to this headline">#</a></h1>
<p>So far, pandas probably seems like a more user friendly NumPy. However, it allows much greater flexibility that NumPy does not.</p>
<p>A common operation in psychology is to examine how some measure varies between or across groups. For example, if we measure depression and want to see how it differs between men and women, we will need to average depression scores separately for men and women. You’re experienced enough to know many psychology experiments have many more complex designs - one score under different levels of different variables.</p>
<p>How could you calculate those means and standard deviations in your raw data? You could use very complex subsettings for this in an array. But Pandas has a method which is the forefront of the <strong>split-apply-combine</strong> approach.</p>
<p>This can be confusing, but very powerful - its worth learning in detail.</p>
<p><img alt="split_apply" src="../_images/sac.png" /></p>
<ul class="simple">
<li><p>From <a class="reference external" href="https://jakevdp.github.io/PythonDataScienceHandbook/03.08-aggregation-and-grouping.html">The Python Data Science Handbook</a></p></li>
</ul>
<p>The <strong>split-apply-combine</strong> approach works by taking a set of data, and subsetting it (i.e., split) into sub-groups where the grouping variable of choice is constant.</p>
<p>Then, the desired function is applied - this could be the mean, standard deviation, or some other more complex function.</p>
<p>Finally, the newly calculated data is combined back into a DataFrame that looks similar in appearance to the original.</p>
<p>Sounds like a lot of work - but pandas makes this easy using the <code class="docutils literal notranslate"><span class="pre">.groupby()</span></code> method.</p>
<p><code class="docutils literal notranslate"><span class="pre">.groupby()</span></code> is called on a DataFrame, and takes a keyword, <code class="docutils literal notranslate"><span class="pre">by</span></code>. This tells the DataFrame to split by the unique values in this variable. Its worth noting Pandas won’t return anything at this point - just that it has rearranged your data in an efficient way and is ready to apply some functions.</p>
<p>A simple example - compute the mean values of all variables in the <code class="docutils literal notranslate"><span class="pre">mtcars</span></code> dataset, differing between <em>automatic or manual</em> cars - stored in the <code class="docutils literal notranslate"><span class="pre">am</span></code> variable (has 0 or 1).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Demonstrate groupby</span>
<span class="n">grouped</span> <span class="o">=</span> <span class="n">mtcars</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;am&#39;</span><span class="p">)</span>

<span class="c1"># Look</span>
<span class="nb">print</span><span class="p">(</span><span class="n">grouped</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;pandas.core.groupby.generic.DataFrameGroupBy object at 0x1222133d0&gt;
</pre></div>
</div>
</div>
</div>
<p>You get a special ‘object’ that indicates your data is successfully split, but has all the usual methods of a DataFrame that you can use to interact with.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Now apply a function - mean</span>
<span class="n">means</span> <span class="o">=</span> <span class="n">grouped</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

<span class="n">display</span><span class="p">(</span><span class="n">means</span><span class="p">)</span>

<span class="c1"># One line</span>
<span class="n">one_liner</span> <span class="o">=</span> <span class="n">mtcars</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;am&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">display</span><span class="p">(</span><span class="n">one_liner</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>mpg</th>
      <th>cyl</th>
      <th>disp</th>
      <th>hp</th>
      <th>drat</th>
      <th>wt</th>
      <th>qsec</th>
      <th>vs</th>
      <th>gear</th>
      <th>carb</th>
    </tr>
    <tr>
      <th>am</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>17.147368</td>
      <td>6.947368</td>
      <td>290.378947</td>
      <td>160.263158</td>
      <td>3.286316</td>
      <td>3.768895</td>
      <td>18.183158</td>
      <td>0.368421</td>
      <td>3.210526</td>
      <td>2.736842</td>
    </tr>
    <tr>
      <th>1</th>
      <td>24.392308</td>
      <td>5.076923</td>
      <td>143.530769</td>
      <td>126.846154</td>
      <td>4.050000</td>
      <td>2.411000</td>
      <td>17.360000</td>
      <td>0.538462</td>
      <td>4.384615</td>
      <td>2.923077</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>mpg</th>
      <th>cyl</th>
      <th>disp</th>
      <th>hp</th>
      <th>drat</th>
      <th>wt</th>
      <th>qsec</th>
      <th>vs</th>
      <th>gear</th>
      <th>carb</th>
    </tr>
    <tr>
      <th>am</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>17.147368</td>
      <td>6.947368</td>
      <td>290.378947</td>
      <td>160.263158</td>
      <td>3.286316</td>
      <td>3.768895</td>
      <td>18.183158</td>
      <td>0.368421</td>
      <td>3.210526</td>
      <td>2.736842</td>
    </tr>
    <tr>
      <th>1</th>
      <td>24.392308</td>
      <td>5.076923</td>
      <td>143.530769</td>
      <td>126.846154</td>
      <td>4.050000</td>
      <td>2.411000</td>
      <td>17.360000</td>
      <td>0.538462</td>
      <td>4.384615</td>
      <td>2.923077</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Adding complexity to this is very simple. If you want to split by more variables, pass them as a list to <code class="docutils literal notranslate"><span class="pre">groupby()</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Group by transmission (am) and by number of gears (gear)</span>
<span class="n">trans_gear</span> <span class="o">=</span> <span class="n">mtcars</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;am&#39;</span><span class="p">,</span> <span class="s1">&#39;gear&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">display</span><span class="p">(</span><span class="n">trans_gear</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>mpg</th>
      <th>cyl</th>
      <th>disp</th>
      <th>hp</th>
      <th>drat</th>
      <th>wt</th>
      <th>qsec</th>
      <th>vs</th>
      <th>carb</th>
    </tr>
    <tr>
      <th>am</th>
      <th>gear</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="2" valign="top">0</th>
      <th>3</th>
      <td>16.106667</td>
      <td>7.466667</td>
      <td>326.3000</td>
      <td>176.133333</td>
      <td>3.132667</td>
      <td>3.8926</td>
      <td>17.692</td>
      <td>0.20</td>
      <td>2.666667</td>
    </tr>
    <tr>
      <th>4</th>
      <td>21.050000</td>
      <td>5.000000</td>
      <td>155.6750</td>
      <td>100.750000</td>
      <td>3.862500</td>
      <td>3.3050</td>
      <td>20.025</td>
      <td>1.00</td>
      <td>3.000000</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">1</th>
      <th>4</th>
      <td>26.275000</td>
      <td>4.500000</td>
      <td>106.6875</td>
      <td>83.875000</td>
      <td>4.133750</td>
      <td>2.2725</td>
      <td>18.435</td>
      <td>0.75</td>
      <td>2.000000</td>
    </tr>
    <tr>
      <th>5</th>
      <td>21.380000</td>
      <td>6.000000</td>
      <td>202.4800</td>
      <td>195.600000</td>
      <td>3.916000</td>
      <td>2.6326</td>
      <td>15.640</td>
      <td>0.20</td>
      <td>4.400000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>This is an easy way to group your data. But sometimes you don’t want all of your variables out of a groupby object. In that case, simply <em>index</em> the groupby object before applying the function!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Get mean miles per gallon from am and gear</span>
<span class="n">mean_mpg</span> <span class="o">=</span> <span class="n">mtcars</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;am&#39;</span><span class="p">,</span> <span class="s1">&#39;gear&#39;</span><span class="p">])[[</span><span class="s1">&#39;mpg&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">display</span><span class="p">(</span><span class="n">mean_mpg</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>mpg</th>
    </tr>
    <tr>
      <th>am</th>
      <th>gear</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="2" valign="top">0</th>
      <th>3</th>
      <td>16.106667</td>
    </tr>
    <tr>
      <th>4</th>
      <td>21.050000</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">1</th>
      <th>4</th>
      <td>26.275000</td>
    </tr>
    <tr>
      <th>5</th>
      <td>21.380000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<section id="reset-index-a-note">
<h2><span class="section-number">4.1. </span><code class="docutils literal notranslate"><span class="pre">.reset_index()</span></code> - a note<a class="headerlink" href="#reset-index-a-note" title="Permalink to this headline">#</a></h2>
<p>You might notice that the index of the DataFrames look a little unusual - there appears to be a kind of ‘nested’ structure to them. This is intentional on Python’s part - it allows you to  store multidimensional (more than 2) data in the essentially 2D data structure of the DataFrame. This is known as a <code class="docutils literal notranslate"><span class="pre">MultiIndex</span></code>, which we won’t use much in this course.</p>
<p>You can easily remove it back to a standard representation by using the <code class="docutils literal notranslate"><span class="pre">.reset_index()</span></code> method.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Reset </span>
<span class="n">display</span><span class="p">(</span><span class="n">mean_mpg</span><span class="o">.</span><span class="n">reset_index</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>am</th>
      <th>gear</th>
      <th>mpg</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>3</td>
      <td>16.106667</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0</td>
      <td>4</td>
      <td>21.050000</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>4</td>
      <td>26.275000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>5</td>
      <td>21.380000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="other-pandas-data-manipulation-tools-transform">
<h2><span class="section-number">4.2. </span>Other pandas data manipulation tools - <code class="docutils literal notranslate"><span class="pre">.transform()</span></code><a class="headerlink" href="#other-pandas-data-manipulation-tools-transform" title="Permalink to this headline">#</a></h2>
<p>There are two more tools to know about for manipulating data with Pandas.</p>
<p>The first is <code class="docutils literal notranslate"><span class="pre">.transform()</span></code>. This allows you to apply a function of your choice to a DataFrame, but with the restriction that the output <em>will be forced</em> to be the same size as the original DataFrame. This is helpful when you want to have a value repeated, rather, as you have seen, collapsing the data down into a smaller or different sized DataFrame. An example will help:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Subset mt cars with just a few variables</span>
<span class="n">sub</span> <span class="o">=</span> <span class="n">mtcars</span><span class="p">[[</span><span class="s1">&#39;model&#39;</span><span class="p">,</span> <span class="s1">&#39;gear&#39;</span><span class="p">,</span> <span class="s1">&#39;hp&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">display</span><span class="p">(</span><span class="n">sub</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>model</th>
      <th>gear</th>
      <th>hp</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Mazda RX4</td>
      <td>4</td>
      <td>110</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Mazda RX4 Wag</td>
      <td>4</td>
      <td>110</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Datsun 710</td>
      <td>4</td>
      <td>93</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Hornet 4 Drive</td>
      <td>3</td>
      <td>110</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Hornet Sportabout</td>
      <td>3</td>
      <td>175</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Group by the number of gears, then &#39;transform&#39; by computing the mean of HP - add this back to the original DF!</span>
<span class="n">sub</span><span class="p">[</span><span class="s1">&#39;Subgroup_Mean_HP&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sub</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;gear&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="s1">&#39;mean&#39;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">sub</span><span class="o">.</span><span class="n">head</span><span class="p">(),</span> <span class="n">sub</span><span class="o">.</span><span class="n">tail</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/var/folders/mw/xt4ddf0j2n3dr4qcr__qhqlr0000gn/T/ipykernel_13315/2279592361.py:2: FutureWarning: Dropping invalid columns in DataFrameGroupBy.transform is deprecated. In a future version, a TypeError will be raised. Before calling .transform, select only columns which should be valid for the function.
  sub[&#39;Subgroup_Mean_HP&#39;] = sub.groupby(&#39;gear&#39;).transform(&#39;mean&#39;)
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>model</th>
      <th>gear</th>
      <th>hp</th>
      <th>Subgroup_Mean_HP</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Mazda RX4</td>
      <td>4</td>
      <td>110</td>
      <td>89.500000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Mazda RX4 Wag</td>
      <td>4</td>
      <td>110</td>
      <td>89.500000</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Datsun 710</td>
      <td>4</td>
      <td>93</td>
      <td>89.500000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Hornet 4 Drive</td>
      <td>3</td>
      <td>110</td>
      <td>176.133333</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Hornet Sportabout</td>
      <td>3</td>
      <td>175</td>
      <td>176.133333</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>model</th>
      <th>gear</th>
      <th>hp</th>
      <th>Subgroup_Mean_HP</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>27</th>
      <td>Lotus Europa</td>
      <td>5</td>
      <td>113</td>
      <td>195.6</td>
    </tr>
    <tr>
      <th>28</th>
      <td>Ford Pantera L</td>
      <td>5</td>
      <td>264</td>
      <td>195.6</td>
    </tr>
    <tr>
      <th>29</th>
      <td>Ferrari Dino</td>
      <td>5</td>
      <td>175</td>
      <td>195.6</td>
    </tr>
    <tr>
      <th>30</th>
      <td>Maserati Bora</td>
      <td>5</td>
      <td>335</td>
      <td>195.6</td>
    </tr>
    <tr>
      <th>31</th>
      <td>Volvo 142E</td>
      <td>4</td>
      <td>109</td>
      <td>89.5</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="other-pandas-data-manipulation-tools-agg">
<h2><span class="section-number">4.3. </span>Other pandas data manipulation tools - <code class="docutils literal notranslate"><span class="pre">.agg()</span></code><a class="headerlink" href="#other-pandas-data-manipulation-tools-agg" title="Permalink to this headline">#</a></h2>
<p>On the other hand, <code class="docutils literal notranslate"><span class="pre">.agg()</span></code> is designed to give you access to a range of ‘aggregation’ functions. It is in a sense the opposite of <code class="docutils literal notranslate"><span class="pre">.transform()</span></code>, because <code class="docutils literal notranslate"><span class="pre">.agg()</span></code> will collapse the DataFrame down into aggregated versions, but offers a wide range of flexibility, including asking for multiple functions, and applying across either rows or columns.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Grab multiple summary statistics from DataFrame</span>
<span class="n">display</span><span class="p">(</span><span class="n">mtcars</span><span class="o">.</span><span class="n">agg</span><span class="p">([</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="s1">&#39;std&#39;</span><span class="p">,</span> <span class="s1">&#39;var&#39;</span><span class="p">,</span> <span class="s1">&#39;sum&#39;</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/var/folders/mw/xt4ddf0j2n3dr4qcr__qhqlr0000gn/T/ipykernel_13315/3822526560.py:2: FutureWarning: [&#39;model&#39;] did not aggregate successfully. If any error is raised this will raise in a future version of pandas. Drop these columns/ops to avoid this warning.
  display(mtcars.agg([&#39;mean&#39;, &#39;std&#39;, &#39;var&#39;, &#39;sum&#39;]))
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>model</th>
      <th>mpg</th>
      <th>cyl</th>
      <th>disp</th>
      <th>hp</th>
      <th>drat</th>
      <th>wt</th>
      <th>qsec</th>
      <th>vs</th>
      <th>am</th>
      <th>gear</th>
      <th>carb</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>mean</th>
      <td>NaN</td>
      <td>20.090625</td>
      <td>6.187500</td>
      <td>230.721875</td>
      <td>146.687500</td>
      <td>3.596563</td>
      <td>3.217250</td>
      <td>17.848750</td>
      <td>0.437500</td>
      <td>0.406250</td>
      <td>3.687500</td>
      <td>2.812500</td>
    </tr>
    <tr>
      <th>std</th>
      <td>NaN</td>
      <td>6.026948</td>
      <td>1.785922</td>
      <td>123.938694</td>
      <td>68.562868</td>
      <td>0.534679</td>
      <td>0.978457</td>
      <td>1.786943</td>
      <td>0.504016</td>
      <td>0.498991</td>
      <td>0.737804</td>
      <td>1.615200</td>
    </tr>
    <tr>
      <th>var</th>
      <td>NaN</td>
      <td>36.324103</td>
      <td>3.189516</td>
      <td>15360.799829</td>
      <td>4700.866935</td>
      <td>0.285881</td>
      <td>0.957379</td>
      <td>3.193166</td>
      <td>0.254032</td>
      <td>0.248992</td>
      <td>0.544355</td>
      <td>2.608871</td>
    </tr>
    <tr>
      <th>sum</th>
      <td>Mazda RX4Mazda RX4 WagDatsun 710Hornet 4 Drive...</td>
      <td>642.900000</td>
      <td>198.000000</td>
      <td>7383.100000</td>
      <td>4694.000000</td>
      <td>115.090000</td>
      <td>102.952000</td>
      <td>571.160000</td>
      <td>14.000000</td>
      <td>13.000000</td>
      <td>118.000000</td>
      <td>90.000000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Notice how pandas warns us that for some columns, things are going wrong. For example, pandas cannot compute the mean of the <code class="docutils literal notranslate"><span class="pre">model</span></code> column - what does it mean to average of a bunch of strings? However, notice it can <em>sum</em> the model names together, because Python can ‘add’ strings together. It warns us we should drop these columns before we do anything, so let us do so, and follow it with a group-by.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Combine with drop/groupby chained operation</span>
<span class="n">grouped_data</span> <span class="o">=</span> <span class="n">mtcars</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="s1">&#39;model&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;am&#39;</span><span class="p">,</span> <span class="s1">&#39;gear&#39;</span><span class="p">])</span>
<span class="n">display</span><span class="p">(</span><span class="n">grouped_data</span><span class="o">.</span><span class="n">agg</span><span class="p">([</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="s1">&#39;std&#39;</span><span class="p">]))</span>

<span class="c1"># Works the same in a single line of course</span>
<span class="n">display</span><span class="p">(</span><span class="n">mtcars</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="s1">&#39;model&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;am&#39;</span><span class="p">,</span> <span class="s1">&#39;gear&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">agg</span><span class="p">([</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="s1">&#39;std&#39;</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th></th>
      <th colspan="2" halign="left">mpg</th>
      <th colspan="2" halign="left">cyl</th>
      <th colspan="2" halign="left">disp</th>
      <th colspan="2" halign="left">hp</th>
      <th colspan="2" halign="left">drat</th>
      <th colspan="2" halign="left">wt</th>
      <th colspan="2" halign="left">qsec</th>
      <th colspan="2" halign="left">vs</th>
      <th colspan="2" halign="left">carb</th>
    </tr>
    <tr>
      <th></th>
      <th></th>
      <th>mean</th>
      <th>std</th>
      <th>mean</th>
      <th>std</th>
      <th>mean</th>
      <th>std</th>
      <th>mean</th>
      <th>std</th>
      <th>mean</th>
      <th>std</th>
      <th>mean</th>
      <th>std</th>
      <th>mean</th>
      <th>std</th>
      <th>mean</th>
      <th>std</th>
      <th>mean</th>
      <th>std</th>
    </tr>
    <tr>
      <th>am</th>
      <th>gear</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="2" valign="top">0</th>
      <th>3</th>
      <td>16.106667</td>
      <td>3.371618</td>
      <td>7.466667</td>
      <td>1.187234</td>
      <td>326.3000</td>
      <td>94.852735</td>
      <td>176.133333</td>
      <td>47.689272</td>
      <td>3.132667</td>
      <td>0.273665</td>
      <td>3.8926</td>
      <td>0.832993</td>
      <td>17.692</td>
      <td>1.349916</td>
      <td>0.20</td>
      <td>0.414039</td>
      <td>2.666667</td>
      <td>1.175139</td>
    </tr>
    <tr>
      <th>4</th>
      <td>21.050000</td>
      <td>3.069745</td>
      <td>5.000000</td>
      <td>1.154701</td>
      <td>155.6750</td>
      <td>13.978883</td>
      <td>100.750000</td>
      <td>29.010056</td>
      <td>3.862500</td>
      <td>0.115000</td>
      <td>3.3050</td>
      <td>0.156738</td>
      <td>20.025</td>
      <td>2.041854</td>
      <td>1.00</td>
      <td>0.000000</td>
      <td>3.000000</td>
      <td>1.154701</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">1</th>
      <th>4</th>
      <td>26.275000</td>
      <td>5.414465</td>
      <td>4.500000</td>
      <td>0.925820</td>
      <td>106.6875</td>
      <td>37.162978</td>
      <td>83.875000</td>
      <td>24.174588</td>
      <td>4.133750</td>
      <td>0.345912</td>
      <td>2.2725</td>
      <td>0.460814</td>
      <td>18.435</td>
      <td>1.158916</td>
      <td>0.75</td>
      <td>0.462910</td>
      <td>2.000000</td>
      <td>1.309307</td>
    </tr>
    <tr>
      <th>5</th>
      <td>21.380000</td>
      <td>6.658979</td>
      <td>6.000000</td>
      <td>2.000000</td>
      <td>202.4800</td>
      <td>115.490636</td>
      <td>195.600000</td>
      <td>102.833847</td>
      <td>3.916000</td>
      <td>0.389525</td>
      <td>2.6326</td>
      <td>0.818925</td>
      <td>15.640</td>
      <td>1.130487</td>
      <td>0.20</td>
      <td>0.447214</td>
      <td>4.400000</td>
      <td>2.607681</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th></th>
      <th colspan="2" halign="left">mpg</th>
      <th colspan="2" halign="left">cyl</th>
      <th colspan="2" halign="left">disp</th>
      <th colspan="2" halign="left">hp</th>
      <th colspan="2" halign="left">drat</th>
      <th colspan="2" halign="left">wt</th>
      <th colspan="2" halign="left">qsec</th>
      <th colspan="2" halign="left">vs</th>
      <th colspan="2" halign="left">carb</th>
    </tr>
    <tr>
      <th></th>
      <th></th>
      <th>mean</th>
      <th>std</th>
      <th>mean</th>
      <th>std</th>
      <th>mean</th>
      <th>std</th>
      <th>mean</th>
      <th>std</th>
      <th>mean</th>
      <th>std</th>
      <th>mean</th>
      <th>std</th>
      <th>mean</th>
      <th>std</th>
      <th>mean</th>
      <th>std</th>
      <th>mean</th>
      <th>std</th>
    </tr>
    <tr>
      <th>am</th>
      <th>gear</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="2" valign="top">0</th>
      <th>3</th>
      <td>16.106667</td>
      <td>3.371618</td>
      <td>7.466667</td>
      <td>1.187234</td>
      <td>326.3000</td>
      <td>94.852735</td>
      <td>176.133333</td>
      <td>47.689272</td>
      <td>3.132667</td>
      <td>0.273665</td>
      <td>3.8926</td>
      <td>0.832993</td>
      <td>17.692</td>
      <td>1.349916</td>
      <td>0.20</td>
      <td>0.414039</td>
      <td>2.666667</td>
      <td>1.175139</td>
    </tr>
    <tr>
      <th>4</th>
      <td>21.050000</td>
      <td>3.069745</td>
      <td>5.000000</td>
      <td>1.154701</td>
      <td>155.6750</td>
      <td>13.978883</td>
      <td>100.750000</td>
      <td>29.010056</td>
      <td>3.862500</td>
      <td>0.115000</td>
      <td>3.3050</td>
      <td>0.156738</td>
      <td>20.025</td>
      <td>2.041854</td>
      <td>1.00</td>
      <td>0.000000</td>
      <td>3.000000</td>
      <td>1.154701</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">1</th>
      <th>4</th>
      <td>26.275000</td>
      <td>5.414465</td>
      <td>4.500000</td>
      <td>0.925820</td>
      <td>106.6875</td>
      <td>37.162978</td>
      <td>83.875000</td>
      <td>24.174588</td>
      <td>4.133750</td>
      <td>0.345912</td>
      <td>2.2725</td>
      <td>0.460814</td>
      <td>18.435</td>
      <td>1.158916</td>
      <td>0.75</td>
      <td>0.462910</td>
      <td>2.000000</td>
      <td>1.309307</td>
    </tr>
    <tr>
      <th>5</th>
      <td>21.380000</td>
      <td>6.658979</td>
      <td>6.000000</td>
      <td>2.000000</td>
      <td>202.4800</td>
      <td>115.490636</td>
      <td>195.600000</td>
      <td>102.833847</td>
      <td>3.916000</td>
      <td>0.389525</td>
      <td>2.6326</td>
      <td>0.818925</td>
      <td>15.640</td>
      <td>1.130487</td>
      <td>0.20</td>
      <td>0.447214</td>
      <td>4.400000</td>
      <td>2.607681</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Even cooler, pass specific functions to specific columns using a dictionary, omitting the need to drop nuisance columns</span>
<span class="n">various</span> <span class="o">=</span> <span class="n">grouped_data</span><span class="o">.</span><span class="n">agg</span><span class="p">({</span><span class="s1">&#39;mpg&#39;</span><span class="p">:[</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="s1">&#39;std&#39;</span><span class="p">],</span> <span class="s1">&#39;hp&#39;</span><span class="p">:</span><span class="s1">&#39;sum&#39;</span><span class="p">,</span> <span class="s1">&#39;cyl&#39;</span><span class="p">:[</span><span class="s1">&#39;var&#39;</span><span class="p">,</span> <span class="s1">&#39;median&#39;</span><span class="p">]})</span>
<span class="n">display</span><span class="p">(</span><span class="n">various</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th></th>
      <th colspan="2" halign="left">mpg</th>
      <th>hp</th>
      <th colspan="2" halign="left">cyl</th>
    </tr>
    <tr>
      <th></th>
      <th></th>
      <th>mean</th>
      <th>std</th>
      <th>sum</th>
      <th>var</th>
      <th>median</th>
    </tr>
    <tr>
      <th>am</th>
      <th>gear</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="2" valign="top">0</th>
      <th>3</th>
      <td>16.106667</td>
      <td>3.371618</td>
      <td>2642</td>
      <td>1.409524</td>
      <td>8.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>21.050000</td>
      <td>3.069745</td>
      <td>403</td>
      <td>1.333333</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">1</th>
      <th>4</th>
      <td>26.275000</td>
      <td>5.414465</td>
      <td>671</td>
      <td>0.857143</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>21.380000</td>
      <td>6.658979</td>
      <td>978</td>
      <td>4.000000</td>
      <td>6.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Sometimes, you don’t want the grouping variables to be in the index. If so, you can pass <code class="docutils literal notranslate"><span class="pre">as_index=False</span></code> in the call to <code class="docutils literal notranslate"><span class="pre">groupby</span></code>. In addition, the <code class="docutils literal notranslate"><span class="pre">agg</span></code> function supports a named-tuple assignment that allows you to change the names of the resulting aggregation outputs. Lets see what that looks like:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Demonstrate as_index=False and named tuple assignment</span>
<span class="n">cool</span> <span class="o">=</span> <span class="n">mtcars</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;am&#39;</span><span class="p">,</span> <span class="s1">&#39;gear&#39;</span><span class="p">],</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="n">average_mpg_right_here</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;mpg&#39;</span><span class="p">,</span> <span class="s1">&#39;mean&#39;</span><span class="p">))</span>
<span class="n">display</span><span class="p">(</span><span class="n">cool</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>am</th>
      <th>gear</th>
      <th>average_mpg_right_here</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>3</td>
      <td>16.106667</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0</td>
      <td>4</td>
      <td>21.050000</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>4</td>
      <td>26.275000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>5</td>
      <td>21.380000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./chapter3"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="booleans.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title"><span class="section-number">3. </span>Boolean operations with Pandas</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="custom_functions_flow.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">5. </span>Custom functions</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Alex Jones, Ph.D<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>